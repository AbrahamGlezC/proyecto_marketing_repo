CREATE DATABASE MARKETING_DB;
USE MARKETING_DB;

CREATE TABLE MARKETING_CAMPAIGNS (
    CAMPAIGN_ID INT,
    COMPANY VARCHAR(100),
    CAMPAIGN_TYPE VARCHAR(100),
    TARGET_AUDIENCE VARCHAR(200),
    DURATION VARCHAR(100),
    CHANNEL_USED VARCHAR(100),
    CONVERSION_RATE DECIMAL(5,2),
    ACQUISITION_COST DECIMAL(10,2),
    ROI DECIMAL (10,2),
    LOCATION VARCHAR(100),
    LANGUAGE VARCHAR(50),
    CLICKS INT,
    IMPRESSIONS INT,
    ENGAGEMENT_SCORE DECIMAL (5,2),
    CUSTOMER_SEGMENT VARCHAR (100),
    DATE DATE
);

-- Habilitar carga local de archivos (si es necesario en tu entorno)
SET GLOBAL local_infile = 1;

-- IMPORTANTE:
-- Cambia 'ruta/al/archivo' por la ruta real donde esté tu archivo CSV en tu equipo:
LOAD DATA LOCAL INFILE 'ruta/al/archivo/marketing_campaign_dataset.csv'
INTO TABLE MARKETING_CAMPAIGNS
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

-- Validaciones y exploración inicial
SELECT * FROM MARKETING_CAMPAIGNS LIMIT 10;
DESCRIBE MARKETING_CAMPAIGNS;

SELECT 
    SUM(CASE WHEN CAMPAIGN_ID IS NULL THEN 1 ELSE 0 END) AS NULL_CAMPAIGN_ID,
    SUM(CASE WHEN COMPANY IS NULL THEN 1 ELSE 0 END) AS NULL_COMPANY,
    SUM(CASE WHEN CAMPAIGN_TYPE IS NULL THEN 1 ELSE 0 END) AS NULL_CAMPAIGN_TYPE,
    SUM(CASE WHEN TARGET_AUDIENCE IS NULL THEN 1 ELSE 0 END) AS NULL_TARGET_AUDIENCE,
    SUM(CASE WHEN DURATION IS NULL THEN 1 ELSE 0 END) AS NULL_DURATION,
    SUM(CASE WHEN CHANNEL_USED IS NULL THEN 1 ELSE 0 END) AS NULL_CHANNEL_USED,
    SUM(CASE WHEN CONVERSION_RATE IS NULL THEN 1 ELSE 0 END) AS NULL_CONVERSION_RATE,
    SUM(CASE WHEN ACQUISITION_COST IS NULL THEN 1 ELSE 0 END) AS NULL_ACQUISITION_COST,
    SUM(CASE WHEN ROI IS NULL THEN 1 ELSE 0 END) AS NULL_ROI,
    SUM(CASE WHEN LOCATION IS NULL THEN 1 ELSE 0 END) AS NULL_LOCATION,
    SUM(CASE WHEN LANGUAGE IS NULL THEN 1 ELSE 0 END) AS NULL_LANGUAGE,
    SUM(CASE WHEN CLICKS IS NULL THEN 1 ELSE 0 END) AS NULL_CLICKS,
    SUM(CASE WHEN IMPRESSIONS IS NULL THEN 1 ELSE 0 END) AS NULL_IMPRESSIONS,
    SUM(CASE WHEN ENGAGEMENT_SCORE IS NULL THEN 1 ELSE 0 END) AS NULL_ENGAGEMENT_SCORE,
    SUM(CASE WHEN CUSTOMER_SEGMENT IS NULL THEN 1 ELSE 0 END) AS NULL_CUSTOMER_SEGMENT,
    SUM(CASE WHEN DATE IS NULL THEN 1 ELSE 0 END) AS NULL_DATE
FROM MARKETING_CAMPAIGNS;
